# 3CAC

3CAC is a three-class classifier designed to classify contigs in mixed metagenome assemblies as phages, plasmids, chromosomes, or uncertain. 

# Requirements

3CAC generates its initial classification by existing classifiers: viralVerify, PPR-Meta, PlasClass, and deepVirFinder. Thus, prior to running 3CAC, installation of these tools are required. Note that, user can install either viralVerify or PPR-Meta as prefered. 3CAC doesn't require to install both of them. Installation of PlasClass and DeepVirFinder are required.

* viralVerify (https://github.com/ablab/viralVerify)
* PPR-Meta (https://github.com/zhenchengfang/PPR-Meta)
* PlasClass (https://github.com/Shamir-Lab/PlasClass)
* DeepVirFinder (https://github.com/jessieren/DeepVirFinder)

To run 3CAC, please download the `3CAC` folder. 3CAC is written in Java and requires Java Runtime Environment. 

# Usage

3CAC requires the following input files: (a) a "fasta" file containing contigs to be classified. (b) a "gfa" file containing the assembly graph generated by metaSPAdes or metaFlye when assembling reads to generate the contigs. (c) a file containing path information for each contig. 

For contigs assembled from short reads by metaSPAdes, user can use files `scaffolds.fasta`, `assembly_graph_with_scaffolds.gfa`, and `scaffolds.path` as input.
for contigs assembled from long reads by metaFlye, user can use files `assembly.fasta`, `assembly_graph.gfa`, `assembly_info.txt` as input.

## 1. Generation of the initial classification

(1) Run either `viralVerify` or `PPR-Meta` on the contig file to classify each of the input contigs as phage, plasmid, chromosome, or uncertain.

(2) Generate files `phageContigs.fasta` and `plasmidContigs.fasta` containing contigs classified as phages and plasmids by step (1).
   ```sh
   java PhageAndPlasmidContigs --contigs contig_file.fasta --PPRMeta(or --viralVerify) output_file_of_PPRMeta_or_viralVerify.csv
   ```   

(3) Run `PlasClass` on `plasmidContigs.fasta` and run `DeepVirFinder` on `phageContigs.fasta`.

(4) Generate file `3CAC_initial_classification.fasta` containing the initial classification result of 3CAC. 
   ```sh
   java InitialClassification3CAC --assembler Flye/SPAdes --PPRMeta(or --viralVerify) output_file_of_PPRMeta_or_viralVerify.csv --PlasClass output_file_of_PlasClass.probs.out --deepVirFinder output_file_of_deepVirFinder.txt
   ```


## 2. Generatation of the final classification

Generate file `3CAC_classification.fasta` containing the final classification result of 3CAC. 
```sh
java Algorithm3CAC --assembler Flye/SPAdes --initial 3CAC_initial_classification.fasta --graph assembly_graph_file.gfa --path scaffolds.path/assembly_info.txt
```





# Contacts

In case of any questions or suggestions please feel free to contact lianrong.pu@gmail.com
